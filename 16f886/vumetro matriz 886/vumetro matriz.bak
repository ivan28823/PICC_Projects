#include <16f886.h>
#device adc=10

#FUSES NOWDT,INTRC_IO,MCLR,NOBROWNOUT,NOPUT,NOPROTECT,NOCPD,IESO,FCMEN
#use delay(clock=8M)

#BYTE TRISA=0x85
#BYTE TRISB=0x86
#BYTE TRISC=0x87
#BYTE PORTA=0x05
#BYTE PORTB=0x06
#BYTE PORTC=0x07

void anuncio(int letrero);
int comprobar_adc(long analog);
//Programa pricipal
void main()
{
   Trisc=0;Portc=0;
   Trisb=0;Portb=0;
   Trisa=0xFF;
   setup_oscillator(OSC_8MHZ);
   setup_adc_ports(sAN0 | sAN1 | VSS_VREF);
   setup_adc(ADC_CLOCK_INTERNAL);
   while(true)
   {
      anuncio(1);   
   }
   //anuncio(1);
   //short f_mod=false;
   //int modo=2;
   /*while(true)
   {
      set_adc_channel(modo-1);
      delay_us(15);
      if(!f_mod)
      {   
         anuncio(modo+1);
         f_mod=true;
      }
      portb=1;
      for(int j=0;j<8;++j)
      {
         Portc=comprobar_adc(read_adc());
         delay_us(2250);
         portb<<=1;
         if(!input(PIN_A5))
         {
            if(modo==1)
               modo=2;
            else
               modo=1;
            f_mod=false;
            delay_ms(200);
            break;
         }
      }
   }*/
}
void anuncio(int letrero)
{
   const int abcd[]=
{
   /* 0*/   62 ,  69 ,  73 ,  81 ,  62 ,  0  ,
   /* 1*/   17 ,  33 ,  127   ,  1  ,  1  ,  0  ,
   /* 2*/   33 ,  67 ,  69 ,  73 ,  49 ,  0  ,
   /* 3*/   34 ,  65 ,  73 ,  73 ,  54 ,  0  ,
   /* 4*/   12 ,  20 ,  36 ,  127   ,  4  ,  0  ,
   /* 5*/   114   ,  81 ,  81 ,  81 ,  78 ,  0  ,
   /* 6*/   62 ,  73 ,  73 ,  73 ,  38 ,  0  ,
   /* 7*/   64 ,  71 ,  72 ,  80 ,  96 ,  0  ,
   /* 8*/   54 ,  73 ,  73 ,  73 ,  54 ,  0  ,
   /* 9*/   50 ,  73 ,  73 ,  73 ,  62 ,  0  ,
   //10 elementos de 0 a 59
   /* A*/   31 ,  36 ,  68 ,  68 ,  127   ,  0  ,
   /* B*/   127   ,  73 ,  73 ,  73 ,  54 ,  0  ,
   /* C*/   62 ,  65 ,  65 ,  65 ,  34 ,  0  ,
   /* D*/   127   ,  65 ,  65 ,  65 ,  62 ,  0  ,
   /* E*/   127   ,  73 ,  73 ,  73 ,  65 ,  0  ,
   /* F*/   127   ,  72 ,  72 ,  72 ,  64 ,  0  ,
   /* G*/   62 ,  65 ,  65 ,  69 ,  38 ,  0  ,
   /* H*/   127   ,  8  ,  8  ,  8  ,  127   ,  0  ,
   /* I*/   0  ,  65 ,  127   ,  65 ,  0  ,  0  ,
   /* J*/   0  ,  2  ,  65 ,  65 ,  126   ,  0  ,
   /* K*/   127   ,  8  ,  20 ,  34 ,  65 ,  0  ,
   /* L*/   127   ,  1  ,  1  ,  1  ,  1  ,  0  ,
   /* M*/   127   ,  32 ,  24 ,  32 ,  127   ,  0  ,
   /* N*/   127   ,  16 ,  8  ,  4  ,  127   ,  0  ,
   /* O*/   62 ,  65 ,  65 ,  65 ,  62 ,  0  ,
   /* P*/   127   ,  72 ,  72 ,  72 ,  48 ,  0  ,
   /* Q*/   60 ,  66 ,  66 ,  66 ,  61 ,  0  ,
   /* R*/   127   ,  72 ,  76 ,  74 ,  49 ,  0  ,
   /* S*/   50 ,  73 ,  73 ,  73 ,  38 ,  0  ,
   /* T*/   64 ,  64 ,  127   ,  64 ,  64 ,  0  ,
   /* U*/   126   ,  1  ,  1  ,  1  ,  126   ,  0  ,
   /* V*/   124   ,  2  ,  1  ,  2  ,  124   ,  0  ,
   /* W*/   126   ,  1  ,  6  ,  1  ,  126   ,  0  ,
   /* X*/   99 ,  20 ,  8  ,  20 ,  99 ,  0  ,
   /* Y*/   114   ,  9  ,  9  ,  9  ,  126   ,  0  ,
   /* Z*/   67 ,  69 ,  73 ,  81 ,  97 ,  0  ,
   //26 elementos de 60 a 215
   /* a*/   6  ,  21 ,  21 ,  21 ,  15 ,  0  ,
   /* b*/   63 ,  9  ,  9  ,  9  ,  6  ,  0  ,
   /* c*/   14 ,  17 ,  17 ,  17 ,  9  ,  0  ,
   /* d*/   6  ,  9  ,  9  ,  9  ,  63 ,  0  ,
   /* e*/   14 ,  21 ,  21 ,  21 ,  13 ,  0  ,
   /* f*/   8  ,  31 ,  40 ,  40 ,  0  ,  0  ,
   /* g*/   25 ,  37 ,  37 ,  37 ,  62 ,  0  ,
   /* h*/   63 ,  8  ,  8  ,  8  ,  7  ,  0  ,
   /* i*/   0  ,  9  ,  47 ,  1  ,  0  ,  0  ,
   /* j*/   2  ,  1  ,  1  ,  1  ,  94 ,  0  ,
   /* k*/   63 ,  4  ,  10 ,  17 ,  0  ,  0  ,
   /* l*/   62 ,  1  ,  1  ,  1  ,  0  ,  0  ,
   /* m*/   31 ,  16 ,  15 ,  16 ,  31 ,  0  ,
   /* n*/   31 ,  16 ,  16 ,  15 ,  0  ,  0  ,
   /* o*/   14 ,  17 ,  17 ,  17 ,  14 ,  0  ,
   /* p*/   63 ,  36 ,  36 ,  36 ,  24 ,  0  ,
   /* q*/   24 ,  36 ,  36 ,  36 ,  63 ,  0  ,
   /* r*/   0  ,  15 ,  16 ,  16 ,  0  ,  0  ,
   /* s*/   9  ,  21 ,  21 ,  21 ,  18 ,  0  ,
   /* t*/   16 ,  16 ,  62 ,  17 ,  17 ,  0  ,
   /* u*/   30 ,  1  ,  1  ,  2  ,  31 ,  0  ,
   /* v*/   0  ,  30 ,  1  ,  1  ,  30 ,  0  ,
   /* w*/   30 ,  1  ,  14 ,  1  ,  30 ,  0  ,
   /* x*/   17 ,  10 ,  4  ,  10 ,  17 ,  0  ,
   /* y*/   57 ,  5  ,  5  ,  5  ,  62 ,  0  ,
   /* z*/   17 ,  19 ,  21 ,  25 ,  17 ,  0  ,
   //26 elementos de 216 a 371
   /*  */  0   ,  0  ,  0  ,  0  ,  0  ,  0  ,
   //1 elemento de 272 a 377 
};
   const int letras[]={
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*C*/ 126   ,  255   ,  195   ,  195   ,  195   ,  195   ,  231   ,  102   ,  0  ,
   /*E*/   255   ,   255   ,   219   ,   219   ,   219   ,   219   ,   195   ,   195   ,   0   ,
   /*C*/ 126   ,  255   ,  195   ,  195   ,  195   ,  195   ,  231   ,  102   ,  0  ,
   /*Y*/ 224   ,  112   ,  48 ,  63 ,  63 ,  48 ,  112   ,  224   ,  0  ,
   /*T*/ 192   ,  192   ,  192   ,  255   ,  255   ,  192   ,  192   ,  192   ,  0  ,
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*3*/ 0  ,  66 ,  219   ,  219   ,  219   ,  219   ,  255   ,  102   ,  0  ,
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*I*/ 195   ,  195   ,  195   ,  255   ,  255   ,  195   ,  195   ,  195   ,  0  ,
   /*P*/   255   ,   255   ,   204   ,   204   ,   204   ,   204   ,   252   ,   120   ,   0   ,
   /*N*/ 255   ,  255   ,  96 ,  48 ,  24 ,  12 ,  255   ,  255   ,  0  ,
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*S*/   114   ,   251   ,   219   ,   219   ,   219   ,   219   ,   223   ,   78   ,   0   ,
   /*C*/ 126   ,  255   ,  195   ,  195   ,  195   ,  195   ,  231   ,  102   ,  0  ,
   /*E*/   255   ,   255   ,   219   ,   219   ,   219   ,   219   ,   195   ,   195   ,   0   ,
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*6*/   126   ,   255   ,   219   ,   219   ,   219   ,   219   ,   219   ,   78   ,   0   ,
   /*I*/ 195   ,  195   ,  195   ,  255   ,  255   ,  195   ,  195   ,  195   ,  0  ,
   /*M*/ 255   ,  255   ,  96 ,  56 ,  56 ,  96 ,  255   ,  255   ,  0  ,
   /*3*/ 0  ,  66 ,  219   ,  219   ,  219   ,  219   ,  255   ,  102   ,  0  ,
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*I*/ 195   ,  195   ,  195   ,  255   ,  255   ,  195   ,  195   ,  195   ,  0  ,
   /*V*/ 252   ,  254   ,  3  ,  3  ,  3  ,  3  ,  254   ,  252   ,  0  ,
   /*A*/   127   ,   255   ,   204   ,   204   ,   204   ,   204   ,   255   ,   127   ,   0   ,
   /*N*/ 255   ,  255   ,  96 ,  48 ,  24 ,  12 ,  255   ,  255   ,  0  ,
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*M*/ 255   ,  255   ,  96 ,  56 ,  56 ,  96 ,  255   ,  255   ,  0  ,
   /*O*/ 126   ,  255   ,  195   ,  195   ,  195   ,  195   ,  255   ,  126   ,  0  ,
   /*R*/   255   ,   255   ,   216   ,   220   ,   222   ,   219   ,   249   ,   112   ,   0   ,
   /*E*/   255   ,   255   ,   219   ,   219   ,   219   ,   219   ,   195   ,   195   ,   0   ,
   /*N*/ 255   ,  255   ,  96 ,  48 ,  24 ,  12 ,  255   ,  255   ,  0  ,
   /*O*/ 126   ,  255   ,  195   ,  195   ,  195   ,  195   ,  255   ,  126   ,  0  ,   
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   //Mensaje 1 de 0 a 266
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*M*/ 255   ,  255   ,  96 ,  56 ,  56 ,  96 ,  255   ,  255   ,  0  ,
   /*O*/ 126   ,  255   ,  195   ,  195   ,  195   ,  195   ,  255   ,  126   ,  0  ,
   /*D*/ 255   ,  255   ,  195   ,  195   ,  195   ,  195   ,  126   ,  60 ,  0  ,
   /*O*/ 126   ,  255   ,  195   ,  195   ,  195   ,  195   ,  255   ,  126   ,  0  ,
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*1*/ 3  ,  51 ,  99 ,  255   ,  127   ,  3  ,  3  ,  3  ,  0  ,
   //Mensaje 2 de 267 a 321
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*M*/ 255   ,  255   ,  96 ,  56 ,  56 ,  96 ,  255   ,  255   ,  0  ,
   /*O*/ 126   ,  255   ,  195   ,  195   ,  195   ,  195   ,  255   ,  126   ,  0  ,
   /*D*/ 255   ,  255   ,  195   ,  195   ,  195   ,  195   ,  126   ,  60 ,  0  ,
   /*O*/ 126   ,  255   ,  195   ,  195   ,  195   ,  195   ,  255   ,  126   ,  0  ,
   /* */ 0,0,0,//////////////////////////////////////////////////////////////////////3
   /*2*/ 49 ,  115   ,  71 ,  207   ,  219   ,  243   ,  227   ,  67 ,  0  ,
   //Mensaje 3 de 322 a 376
   };   
   long inicio,fin,fin_msj;
   switch(letrero)
   {
      case 1:inicio=0;fin_msj=266;
      break;
      case 2:inicio=267;fin_msj=321;
      break;
      case 3:inicio=322;fin_msj=376;
      break;
   }
   fin=inicio+8;
   fin_msj=377
   do
   {
      for (int j = 0; j < 12; ++j)
      {
         Portb=1;
         for (long i = inicio; i < fin; ++i)
         {
            //Portc=letras[i];
            Portc=abcd[i];
            delay_us(2300);
            Portb<<=1;
         }
      }
      inicio++;fin++;
   }while(fin<=fin_msj);
}
int comprobar_adc(long analog)
{
   int valor=1;
   if(analog<=114) valor=0;
   else if(analog<=277) valor=1;
   else if(analog<=341) valor=3;
   else if(analog<=455) valor=7;
   else if(analog<=568) valor=15;
   else if(analog<=682) valor=31;
   else if(analog<=796) valor=63;
   else if(analog<=910) valor=127;
   else if(analog>910) valor=255;
   return valor;
}
